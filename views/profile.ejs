<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Required meta tags -->
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<!-- Bootstrap CSS -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
			integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
			crossorigin="anonymous"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
		/>
		<title>Dyce&Dyne | Cart | <%= currentUser.name %></title>
		<style>
			.primaryColor {
				background-color: #ffb400;
			}

			.gameButton,
			.gameButton:active {
				border: none;
				outline: none;
			}
			/* Timeline holder */
			ul.timeline {
				list-style-type: none;
				position: relative;
				padding-left: 1.5rem;
			}

			/* Timeline vertical line */
			ul.timeline:before {
				content: " ";
				background: #ffb400;
				display: inline-block;
				position: absolute;
				left: 16px;
				width: 4px;
				height: 100%;
				z-index: 400;
				border-radius: 1rem;
			}

			li.timeline-item {
				margin: 20px 0;
			}

			/* Timeline item arrow */
			.timeline-arrow {
				border-top: 0.5rem solid transparent;
				border-right: 0.5rem solid #ffb400;
				border-bottom: 0.5rem solid transparent;
				display: block;
				position: absolute;
				left: 2rem;
			}

			/* Timeline item circle marker */
			li.timeline-item::before {
				content: " ";
				background: #fff;
				display: inline-block;
				position: absolute;
				border-radius: 50%;
				border: 3px solid #ffb400;
				left: 11px;
				width: 14px;
				height: 14px;
				z-index: 400;
				box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
			}

			.text-gray {
				color: #999;
			}
		</style>
		<link rel="stylesheet" href="/css/navbar.css">
	</head>

	<body>
		<%- include('../partials/navbar.ejs') %>
		<div class="container row d-flex justify-content-center m-auto">
			<div class="col-lg-4 col-sm-6">
				<div class="col-12">
					<div style="box-shadow: 2px 4px 1px gray;" class="card">
						<img class="mt-2"" src="images/8puzzlebg.png" />

						<div class="card-body">
							<h5 class="card-title">8 Puzzle</h5>
							<p class="card-text">
								Artfully headaches! The pieces are to be pushed
								around over the board until the picture is
								complete.
							</p>
							<a
								href="/8puzzle"
								class="btn btn-primary primaryColor gameButton"
								>Play!</a
							>
						</div>
					</div>
				</div>
				<div class="col-12 pt-3">
					<div style="box-shadow: 2px 4px 1px gray;" class="card">
						<svg
							class="bd-placeholder-img card-img-top"
							width="100%"
							height="180"
							xmlns="http://www.w3.org/2000/svg"
							aria-label="Placeholder: Image cap"
							preserveAspectRatio="xMidYMid slice"
							role="img"
						>
							<title>Placeholder</title>
							<rect width="100%" height="100%" fill="#868e96" />
							<text x="50%" y="50%" fill="#dee2e6" dy=".3em">
								Image cap
							</text>
						</svg>

						<div class="card-body">
							<h5 class="card-title">ConnectFour</h5>
							<p class="card-text">
								Take a break to play a game of Connect 4 and
								earn tons of points!
							</p>
							<a
								href="/connect4"
								class="btn btn-primary primaryColor gameButton"
								>Play!</a
							>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-8 col-sm-6">
				<div class="container">
					<div class="text-center mb-0">
						<div class="col-lg-8 mx-auto">
							<h1 class="display-4" style="color: #ffb400; font-weight: 700;">
								<%= currentUser.name %>
							</h1>
							<p class="lead mb-0">
								Wallet Points: <%= currentUser.wallet %> points
							</p>
							<p class="lead">
								Total Orders: <%= currentUser.orders.length %>
							</p>
							<p class="lead mb-0">Order History:</p>
						</div>
					</div>

					<div class="row mt-0">
						<div class="col-lg-12 mx-auto">
							<!-- Timeline -->
							<ul class="timeline">
								<% for(i=0; i< orders.length; i++) { items = []
								for (j = 0; j < orders[i].items.length; j++) {
								items.push(orders[i].items[j].title); }
								itemstring = items.join(', '); %>
								<a style="text-decoration: none; color: black" href="/orderconfirmed/<%= orders[i]._id %>">
								
								
									<li
										class="
											timeline-item
											bg-white
											rounded
											ml-3
											p-4
											shadow
										"
									>
										<div class="timeline-arrow"></div>
										<h3 class="h5 mb-0">
											<% var date = orders[i].date.getDate() %>
											<% var month = orders[i].date.getMonth() + 1 %>
											<% var year = orders[i].date.getFullYear().toString() %>
											<% var d = `${date}/${month}/${year}`%>
											<% var time = orders[i].date.toLocaleTimeString(); %>
											<%= d %>, <small><%= time %></small>
										</h3>
										<span class="small text-gray"
											>Order total: INR <%= orders[i].total %>
										</span>
										<p
											class="
												text-small
												mt-2
												font-weight-light
											"
										>
											Order Summary: <%=itemstring %>
										</p>
									</li>
								</a>
								<% } %>
							</ul>
							<!-- End -->
						</div>
					</div>
				</div>
			</div>
		</div>

		<% if(orders.length == 0) { %>
		<p>No orders placed yet</p>
		<% } else { %>
		<p><%= orders[0].total %></p>
		<% } %>
		<script
			src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
			integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
			crossorigin="anonymous"
		></script>
		<script src="/scripts/navbar.js" ></script>
	</body>
</html>
